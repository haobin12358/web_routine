<style scoped lang="less" rel="stylesheet/less">
  @import "../../styles/common";
  .m-circle-box{
    overflow: auto;
  }
  .m-one-circle{
    padding: 20rpx 30rpx;
    border-bottom: 1px solid #c1c1c1;
    .m-one-circle-title{
      .flex-row(space-between);
      padding-bottom: 10rpx;
      .m-circle-label{
        display: inline-block;
        padding: 0 10rpx;
        background-color: @common-color;
        font-size: 20rpx;
      }
    }
    .m-info{
      font-weight: 600;
      line-height: 56rpx;
    }
    .m-recommend-icon{
      display: inline-block;
      width: 40rpx;
      height: 40rpx;
      margin-right: 20rpx;
    }
    .m-text{
      line-height: 56rpx;
      text-align: left;
      .m-topic{
        color: #006FCE;
      }
    }
    .m-one-img{
      display: block;
      width: 690rpx;
      height: 388rpx;
      margin-bottom: 10rpx;
    }
    .m-img-box{
      .flex-row(flex-start);
      flex-wrap: wrap;
      margin-top: 20rpx;
      .m-img{
        width: 200rpx;
        height: 200rpx;
        margin: 0 20rpx 20rpx 0;
      }
      video{
        width: 690rpx;
        height: 388rpx;
        margin-bottom: 20rpx;
      }
    }
    .m-loc-box{
      .flex-row(flex-start);
      font-size: 24rpx;
      line-height: 33rpx;
      .m-icon-loc{
        display: inline-block;
        width: 40rpx;
        height: 40rpx;
        margin-right: 10rpx;
      }
    }
  }

  .touchView{z-index: 200; width: 750rpx;position: absolute;top: 0;left:0;z-index:999;}

  .edit_row{ position:relative;z-index:777; height: 122px; box-sizing: border-box; margin:0 32rpx 28rpx;border-radius:20rpx;box-shadow: 0 40rpx 40rpx 0 rgba(0,0,0,0.04);
  }

  .edit_row_left{
    width:100%;
    height:100%;
    overflow: hidden;box-sizing: border-box;background:#fff;border-radius:20rpx;
    display: -webkit-flex;display: flex;align-items:center;
    position:absolute;
    left:0;
    top:0;
    z-index:666;
    border-radius:20rpx;
    overflow:hidden;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }
  .edit_col1{ float: left; width: 88rpx;height:88rpx; text-align: center;margin:0 32rpx 0 40rpx;}
  .edit_col2{ float: left; width: 426rpx; height:100%;position:relative;display: -webkit-flex; /* Safari */
    display: flex;flex-direction:column;align-content:center;justify-content: center;}
  .edit_col4{ float: left; width: 23%; text-align: center; position: relative;}
  .edit_del{ float: left;padding-right: 10px; color: #fd7736;}
  .edit_finish{ float: right; padding-right: 10px; width: 24%;height:40px;color: #fd7736;}

  .edit_row_title .edit_col4:before{ content:''; position: absolute; width: 1px; height: 18px; background-color: #e8e8e8; left: 0%; top: 50%; margin-top: -9px; }

  .edit_title_col1{ position: relative; left: 10px; }


  /*.edit_row_holder{ margin-top:82px;}*/

  .edit_row_on .ico_checker{ background-position: 0 -17px;}

  .moveable_row{ width: 100%; position: absolute;top: 0;left: 0; z-index: 100;}
  .moveable_row .edit_row{ box-shadow: 0 0 12px rgba(0,0,0,.2)}
  .moveable_row .edit_row_show{
    box-shadow: 0 30rpx 30rpx 0 rgba(0,0,0,0.12);
  }
  .dragSelected .edit_row_left{ background-color: #f1f1f1 !important;}

  .placeholder{ display: inline-block; width: 1px; height: 1px; }

  /*.ico_checker{ display: inline-block; width: 17px; height: 17px; background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAABECAMAAADTNBe3AAAAtFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD9dzYAAAD9dzb9dzb9dzb9dzb9dzb9dzYAAAAAAAD9dzYAAAD9dzb9dzb9dzb9dzb9dzb9dzb9dzb9dzb9dzb9dzb9dzb9dzb9dzb/////+PT/9O79ezz/7+b+z7j+t5X+nnD9k2D9jVb9h03//Pr/4NH/3c3+2sj+1MD+q4T+pnv9fUD/6Nz+yrH+x6z+waP+sIr+onX9mGYUhiY1AAAAIXRSTlMAMgQkLxIVGQv6Iuy0s31ZPSkgFgchy6Bg8vzMn2Lz8SONyM4YAAABuElEQVRIx4yUSxIDIQhEaT5KudOa+581NZMsNI5i79RXjSJAndhaVUBrM6Y3uaCT+ARcNyDJmYg9PYtrJEyhuXPnrFDriQyUv/BcgDwQiSaljjFg8Jz3L+09Rh/93llQaKECefIB5RXCCn9MMi2V7wgMLE1+pwahjQRGDWmHJDSq8B3iqKTgHcJQAmgr4ASJA51cN370SeriDwi/UU6KIS6puDDj8o6bJG610XNuWFjc9ufD430EpVUyP42UyW7DIBBA54psh0jI4MR2khm7Td026ZLu/f//ah0QgoBN3mkOTwyaTVSNzBjLZFOJqLAsGFrWxTIQyhwvyEvf4FsM2HLXWGCUhWckHI6TmFzlalpZ6T/nOEN+rgfOMtanmFcKAMEwyuP7EUeYgGrCuKUnHVXQTBnHNx0qkDHj4f8NY6CELGb09HyDhgyYiYYhbiCzSkffJrrv6UUbWrGJXonutNEZwyaS6Dja2KNLDcrGp9H5vTRQuaU7HWjf0Qf6tF4Dfg5En+jDhN/Gof8K25gehvRIXTeY6fFOL0l61Sx8EwobDh67cO13keOxDo5HgGhVPZ6gWrXuCfoDrVl7suXteG8AAAAASUVORK5CYII=) 0 0 no-repeat; -webkit-background-size: 100% auto; background-size: 100% auto; margin-top: 7px;}*/

  .ico_delete{ display: inline-block; width: 100%;height:100%; background: url(data:image/png;base64,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) center center no-repeat; -webkit-background-size:100% 100%; background-size: 100% 100%;}

  .ico_drag{ display: inline-block; width: 24px; height: 12px; background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAYCAYAAAC8/X7cAAAAAXNSR0IArs4c6QAAAEtJREFUWAnt1cEJACAMA0B1/506moIr5FEK51+Jl0d2Vd01+JzB2X90H5jeoPwECBDIBLYlzgDj25Y4JvQAAQIERgtY4u76LHF3Aw8rGQnK3sYAXQAAAABJRU5ErkJggg==) 0 0 no-repeat; -webkit-background-size: 100% auto; background-size: 100% auto; margin-top: 10px;}

  .secname{ font-size: 30rpx; line-height: 44rpx;color:#609FA8;font-weight:bold;padding:0 0 8rpx;width:100%;overflow: hidden;
    text-overflow:ellipsis;
    white-space: nowrap;}
  .seccode{ font-size: 22rpx; color:#609FA8; line-height: 28rpx;max-height: 102rpx;text-overflow: -o-ellipsis-lastline;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;}


  .stay_bottom{ height: 50px; }
  .bottom_row{ width: 100%; overflow: hidden; background-color: #fff; line-height: 49px; height: 49px; border-top: 1px #a5a5a5 solid; position: fixed; z-index: 99; left: 0; bottom: 0; font-size: 17px; color: #929292;}

  .stay_bottom .all_select  .ico_checker{background-position: 0 -17px;}
  .edit_row_holder{
    overflow-x:hidden;

  }
  .bt168{
    padding-bottom: 28rpx;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }
  .padding-b168{
    padding-bottom: 168rpx;
  }
  .check_box{
    width:36rpx;
    height:36rpx;
    border-radius:8rpx;
    border:2rpx solid #E5E2DF;
    box-sizing: border-box;
    position:relative;
  }
  .check_padding_box{
    padding:32rpx;
    position: absolute;
    right:0;
    top:72rpx;
    z-index:668;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }
  .mark_icon{
    width:126rpx;
    height:140rpx;
    position:absolute;
    top:-6rpx;
    right:-6rpx;
    z-index:667;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }
  .delet-box{
    background:#609FA8;
    width:108rpx;
    height:100%;
    color:#fff;
    text-align:center;
    line-height:122px;
    font-size:24rpx;
    position:absolute;
    top:0;
    right:0;
    padding-left:578rpx;
    z-index:555;
    border-radius:22rpx;
  }
  .show-delet .edit_row_left{
    left:-108rpx;
  }
  .show-delet .mark_icon{
    right:100rpx;
  }
  .show-delet .check_padding_box{
    right:108rpx;
  }
  .move_row{
    z-index:888;
  }

  .mua_box{
    width:156rpx;
    height:156rpx;
    position:fixed;
    left:0;
    bottom:0;
    z-index:10000;
    overflow-x:hidden;
    -webkit-transition: width 0.3s;
    transition: width 0.3s;
  }
  .mua_box image{
    width:156rpx;
    height:156rpx;
    float:right;
    -webkit-transition: width 0.3s;
    transition: width 0.3s;
  }
  .show_assistant_box{
    width:100%;
    height:168rpx;
  }
  .show_assistant_box image{
    width:100vw;
    height:168rpx;
  }
  .toggle_box{
    width:156rpx;
    height:156rpx;
    position:fixed;
    left:0;
    bottom:0;
    z-index:11111;
  }
  .toggle_box image{
    width:36rpx;
    height:36rpx;
    float:left;
    padding-top:40rpx;
  }
  .completed .secname,.completed .seccode,.completed .address{
    color:#CCC6C0 !important;
  }
  .completed .check_box{
    background:#E5E2DF;
  }
  .completed .delet-box{
    background:#E5E2DF;
  }
  .check_box image{
    width:36rpx;
    height:36rpx;
    position:absolute;
    top:-2rpx;
    left:-2rpx;
  }
  .edit_col1 image{
    width:100%;
    height:100%;
  }
  .arrowR{
    width:8rpx;
    height:18rpx;
    float:right;
    top:112rpx;
    right:44rpx;
    position: absolute;
    z-index:668;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }
  .arrowR-delet{
    right:152rpx;
  }
  .address{
    font-size:24rpx;
    line-height:34rpx;
    color:#609FA8;
    max-width:100%;
    overflow: hidden;
    text-overflow:ellipsis;
    white-space: nowrap;
    margin-top:34rpx;
  }
  .address image{
    width:10rpx;
    height:20rpx;
    padding:4rpx 0 6rpx;
    display:inline-block;
    vertical-align: middle;
  }
  .col-2{
    text-overflow: -o-ellipsis-lastline;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }
  .user-info-box{
    width:100%;
    height:117px;
    background:	#6EBEC7;
    margin-bottom:-36px;
    border-bottom-left-radius:30%;
    border-bottom-right-radius:30%;
    overflow:hidden;
  }
  .user-headimg{
    display:block;
    margin:0 auto;
    width:72rpx;
    height:72rpx;
    border-radius:50%;
  }
  .user-edb{
    margin-top:16rpx;
    font-size:24rpx;
    line-height:34rpx;
    color:#fff;
    text-align: center;
  }
  .user-edb text{
    margin-right:12rpx;
    color:#fff;
    font-weight:500;
  }
  .test{
    position: absolute;
    left:0;
    top:0;
    width:100%;
    height:122px;
    border-radius: 20rpx;
    background:#f1ebe9;
    z-index:777;
  }
  .test-delet{
    opacity: 0;
  }
  .show-delet .test-delet{
    left:-108rpx;
  }
  .branches-checkbox-left{
    position: absolute;
    top:0;
    bottom:0;
    right:98rpx;
    margin:auto;
    width:2rpx;
    height:168rpx;
    z-index:777;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
    background:linear-gradient(#fff,#E5E2DF,#fff);
    -webkit-transform: scaleX(0.5);
    transform: scaleX(0.5);
  }
  .show-delet .branches-checkbox-left{
    right:206rpx;
  }
  .seccode-3{
    max-width:392rpx;
  }
  .m-btn-box{
    height: 80px;
    padding:0 20rpx ;
    .flex-row(flex-end);
    .m-btn{
      display: block;
      width: 120rpx;
      height: 50rpx;
      line-height: 50rpx;
      text-align: center;
      border-radius: 30rpx;
      background-color: @common-color;
    }
  }

</style>
<template>
  <view style="position: relative; z-index: 199;">
    <view class="m-btn-box">
      <span class="m-btn">保存</span>
    </view>
    <!-- catchtouchstart="draggleTouch" -->
    <!-- 监测移动事件 -->
    <view class="touchView" style="height:{{scrollPosition.scrollViewHeight}}px;" @longpress="longpressfuc"
          @touchmove="{{movableViewPosition.data.is_complete?'':'draggleTouch'}}" @touchend="{{movableViewPosition.data.is_complete?'':'draggleTouch'}}">
    </view>
    <!-- 用于展示给用户的移动item -->
    <movable-area class="moveable_row move_row {{movableViewPosition.className}}"
                  style="height: {{scrollPosition.scrollViewHeight}}px;">
      <movable-view style="height: {{scrollPosition.everyOptionCell}}px; width: 100%;"
                    direction="vertical" x="{{movableViewPosition.x}}"  y="{{movableViewPosition.y}}"
                    inertia="false" damping="9999"  friction="9999">
        <view class="edit_row edit_row_show {{movableViewPosition.data.is_complete?'completed':''}}">
          <view class="edit_row_left">
            <view class="edit_col1" data-id="{{movableViewPosition.data.id}}" bindtap="selectOption">
              <!-- icon_type	int	类型（1: 医院医疗类 2:线下活动类 3: 线上讲座类 4:服务消费类 5:社群推荐类） -->
              <image src="/assets/img/icons/1.jpg"></image>
            </view>
            <view class="edit_col2">
              <view class="secname">{{movableViewPosition.data.title}}</view>
              <view class="seccode">{{movableViewPosition.data.desc}}</view>
              <view class="address" wx:if="{{movableViewPosition.data.address != null}}">{{movableViewPosition.data.address}} <image src="{{img_path}}/assets/img/jiandang/card_arrow.png"></image></view>
            </view>
          </view>
          <image wx:if="{{movableViewPosition.data.is_extend}}" src="{{img_path}}/assets/img/icons/arrowR.png" class="arrowR"></image>
          <view class="check_padding_box" wx:if="{{!movableViewPosition.data.is_extend}}">
            <view class="check_box"><image src="{{img_path}}/assets/img/icons/CheckBox@3x.png" wx:if="{{movableViewPosition.data.is_complete}}"></image></view>
          </view>
          <image src="{{img_path}}/assets/img/jiandang/Mark@3x.png" class="mark_icon" wx:if="{{!movableViewPosition.data.readed && movableViewPosition.data.is_extend}}"></image>
        </view>
      </movable-view>
    </movable-area>


    <!-- 页面card -->
    <scroll-view class="edit_row_holder" scroll-y="{{scrollPosition.scrollY}}"
                 style="height: {{scrollPosition.scrollViewHeight}}px;" @scroll="bindscroll"  @scrolltolower="scrolltolower">
      <!-- 用户信息 end -->
      <block wx:for="{{optionsListData}}" wx:key="id">
        <view class="edit_row  {{item.selectClass}} {{item.show_delet?'show-delet':''}} {{item.is_complete?'completed':''}}" data-index="{{index}}" bindtouchmove="handletouchmove" bindtouchstart="handletouchstart" bindtouchend="handletouchend" animation="{{animation_flag == index ? animationData :''}}">
          <view class="test" wx:if="{{item.selectClass == 'dragSelected'}}"></view>
          <view class="test test-delet" wx:if="{{item.show_delet}}" data-index="{{index}}" catchtap="fadeoutBox"></view>
          <view class="edit_row_left" bindtap="{{item.is_extend || item.style_type == 3 ? 'goUrl':''}}" data-url="{{item.url}}" data-id="{{item.id}}" data-status="{{item.is_complete?'0':'1'}}" data-index="{{index}}">
            <view class="edit_col1" data-id="{{item.id}}">
              <!-- icon_type	int	类型（1: 医院医疗类 2:线下活动类 3: 线上讲座类 4:服务消费类 5:社群推荐类 6:提示类） -->
              <image src="/assets/img/icons/1.jpg"></image>
            </view>
            <view class="edit_col2">
              <view class="secname">{{item.title}}</view>
              <view class="seccode {{item.style_type == 3?'seccode-3':''}} {{item.address != null?'col-2':''}}">{{item.desc}}</view>
              <view class="address" wx:if="{{item.address != null}}" catchtap="goMap" data-index="{{index}}">{{item.address}} </view>
            </view>

          </view>
          <view class="branches-checkbox-left" wx:if="{{item.style_type == 3}}"></view>
          <image wx:if="{{item.is_extend}}" src="{{img_path}}/assets/img/icons/arrowR.png" class="arrowR {{item.show_delet?'arrowR-delet':''}}"></image>
          <view class="check_padding_box" data-flag="{{index}}" data-id="{{item.id}}" wx:if="{{!item.is_extend}}">
            <view class="check_box"><image src="{{img_path}}/assets/img/icons/CheckBox@3x.png" wx:if="{{item.is_complete}}"></image></view>
          </view>
          <image src="{{img_path}}/assets/img/jiandang/Mark@3x.png" class="mark_icon" wx:if="{{!item.readed && item.is_extend}}"></image>

          <view class="delet-box" data-id="{{item.id}}">忽略</view>
        </view>
      </block>
    </scroll-view>


  </view>




</template>

<script>
  import wepy from 'wepy';
  import api from '../../api/api';
  import tip from '../../utils/tip';

  export default class scrollCircle extends wepy.page {

    components = {

    }
    data = {
      pageStatus:'',
      optionsListData:[],
      movableViewPosition:{
        x:0,
        y:80,
        className:"none",
        data:{
          icon_type:1,
          is_complete:true
        }
      },
      scrollPosition:{
        everyOptionCell:136,
        top:0,
        scrollTop:0,
        scrollY:true,
        scrollViewHeight:1334,
        scrollViewWidth:375,
        windowViewHeight:1334,
      },
      selectItemInfo:{
        title:"",
        address:"",
        desc:"",
        selectIndex: -1,
        selectPosition:0,
      },
      flag:0,
      show_assistant:true,
      animation_flag:'',
      page:0,
      has_next:true,
      isShow: false,
      move_type:'',
      user:{
        headimgurl:'https://avatars2.githubusercontent.com/u/24517605?s=460&v=4',
        expected_birth_week:'拖拽排序+左滑删除'
      },
      navigationBarTitle:''

    }
    postData(id,index){
      let that = this;
      wepy.request({
        url: api.collect + '?token=' +wx.getStorageSync('token'),
        method:"post",
        data:{
          uclcotype:2,
          uclcollection:id
        }
      }).then(resule => {
        if(resule.data.status == 200){
          for(let i =0;i<that.list.length;i++){
            if(that.list[i].author.usid == id){
              that.list[i].followed = !that.list[i].followed
            }
          }
          wx.showToast({
            title: resule.data.message,
            icon: 'success',
            duration: 2000
          })
          that.$apply();
        }
      })
    }
    onLoad(options) {
      var systemInfo= wx.getSystemInfoSync();
      // 开始加载页面
      var scrollViewHeight = systemInfo.windowHeight;
      var scrollViewWidth = systemInfo.windowWidth;
      this.setData({
        'scrollPosition.scrollViewWidth':scrollViewWidth,
        'scrollPosition.scrollViewHeight':scrollViewHeight,
        'scrollPosition.windowViewHeight':systemInfo.windowHeight,
      });
      this.setData({
        img_path:''
      })
      let that = this;
      that.setData({
        page:0
      })
      that.getData();
      that.pageInit();

    }
    getData(){
      var that=this;
      var optionsList = [
        {"id":1,"title":"拖拽测试-1","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":1,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":2,"title":"拖拽测试-2","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":2,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":3,"title":"拖拽测试-3","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":3,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":4,"title":"拖拽测试-4","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":4,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":5,"title":"拖拽测试-5","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":5,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":6,"title":"拖拽测试-6","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":4,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":7,"title":"拖拽测试-7","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":1,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":8,"title":"拖拽测试-8","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":2,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":9,"title":"拖拽测试-9","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":1,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false},
        {"id":10,"title":"拖拽测试-10","desc":"长按左侧图标拖拽排序，左滑删除","address":"北京市朝阳区北京市朝阳区","icon_type":3,"is_complete":false,"show_delet":false,"selectClass":"","url":"","is_extend":false}
      ];
      that.pageStatus = 'ok';
      that.optionsListData = optionsList;

      that.has_next = false;
      that.move_type = '';
      that.$apply();
      console.log(that.optionsListData,'adadsa')
    }
    pageInit(){
      // 优先使用全局变量中位置信息，没有则重新请求位置信息
      var that =this;
    }
    scrollTouchStart(event) {
      var that=this;
      // console.log('开始');
      var firstTouchPosition = {
        x:event.changedTouches[0].pageX,
        y:event.changedTouches[0].pageY,
      }
      console.log("firstTouchPosition:",firstTouchPosition);
      var domData = that.getPositionDomByXY(firstTouchPosition);
      domData.show_delet = false;

      // 排序时禁止已完成card移动------start--------
      if(that.data.move_type != 'reset_status' && domData.is_complete){
        that.movableViewPosition={
          x:0,
          y:80,
          className:"none",
          data:{
            icon_type:1,
            is_complete:true
          }
        }
        that.$apply();
        return false;
      }
      // 排序时禁止已完成card移动------end--------

      // console.log("domData:",domData);

      //movable-area滑块位置处理
      var movableX = 0;
      var movableY = firstTouchPosition.y-that.data.scrollPosition.top-that.data.scrollPosition.everyOptionCell/2;

      that.movableViewPosition={
        x:movableX,
        y:movableY,
        className:"none",
        data:domData
      }
      that.$apply();
      setTimeout(function(){
        that.movableViewPosition = {
          x:movableX,
          y:movableY,
          className:"",
          data:domData
        }
        that.$apply();
      },10)
      var id = domData.id;
      var secInfo = that.getOptionInfo(id);
      secInfo.selectPosition =  event.changedTouches[0].clientY;
      secInfo.selectClass = "dragSelected";

      that.data.optionsListData[secInfo.selectIndex].selectClass = "dragSelected";

      var optionsListData = that.data.optionsListData;

      that.scrollPosition.scrollY=false;
      that.selectItemInfo =secInfo;
      that.optionsListData = optionsListData;
      that.scrollPosition.selectIndex =secInfo.selectIndex
      that.$apply();
    }
    scrollTouchMove(event) {//频繁setdata导致性能问题，页面拖动卡顿
      // console.log('移动');
      var that=this;
      var selectItemInfo = that.data.selectItemInfo;
      var selectPosition = selectItemInfo.selectPosition;
      var moveDistance   = event.changedTouches[0].clientY+81;
      var everyOptionCell = that.data.scrollPosition.everyOptionCell;
      var optionsListData = that.data.optionsListData;
      var selectIndex = selectItemInfo.selectIndex;
      // console.log("event.changedTouches:",event.changedTouches);
      //movable-area滑块位置处理
      var movableX = 0;
      var movableY = event.changedTouches[0].pageY-that.data.scrollPosition.top-that.data.scrollPosition.everyOptionCell/2;


      that.movableViewPosition = {
        x:movableX,
        y:movableY,
        className:"",
        data:that.data.movableViewPosition.data
      }
      that.$apply();

      if(moveDistance - selectPosition > 0 && selectIndex < optionsListData.length - 1){
        if (optionsListData[selectIndex].id == selectItemInfo.id) {
          optionsListData.splice(selectIndex, 1);
          optionsListData.splice(++selectIndex, 0, selectItemInfo);
          selectPosition += everyOptionCell;
        }
      }

      if (moveDistance - selectPosition < 0 && selectIndex > 0) {
        if (optionsListData[selectIndex].id == selectItemInfo.id) {
          optionsListData.splice(selectIndex, 1);
          optionsListData.splice(--selectIndex, 0, selectItemInfo);
          selectPosition -= everyOptionCell;
        }
      }

      that.selectItemInfo.selectPosition= selectPosition;
      that.selectItemInfo.selectIndex = selectIndex;
      that.optionsListData = optionsListData;
      that.$apply();
    }
    scrollTouchEnd(event) {
      // console.log('结束');
      var that=this;
      var optionsListData = that.optionsDataTranlate(that.data.optionsListData,"");

      that.optionsListData = optionsListData
      that.scrollPosition.scrollY = true;
      that.movableViewPosition.className ="none";
      that.movableViewPosition.is_complete = true
      var movableViewPosition={
        x:0,
        y:80,
        className:"none",
        data:{
          icon_type:1,
          is_complete:true
        }
      };
      if(that.data.move_type != 'reset_status'){
        // console.log('排序');
        that.movableViewPosition =movableViewPosition

        var selectItemInfo = that.data.selectItemInfo;
        for(let i=0;i<optionsListData.length;i++){
          if(selectItemInfo.id == optionsListData[i].id){
            if(optionsListData[i].sortNum == i){//原有顺序=当前顺序，未改变位置
              return false;
            }
            var relation_id='';
            if(i == 0){//移动后处于首位，上移
              relation_id=optionsListData[i+1].id;
              that.updateList(selectItemInfo.id,'reset_weight',relation_id);
              return false;
            }
            if(i == (optionsListData.length - 1) ){//移动后处于末尾位，下移
              relation_id=optionsListData[i-1].id;
              that.updateList(selectItemInfo.id,'reset_weight',relation_id);
              return false;
            }

            var pre_num=optionsListData[i-1].sortNum;//上一条数据初始顺序
            var curr_num=optionsListData[i].sortNum;//移动数据初始顺序
            if(pre_num > curr_num){ //下移
              relation_id=optionsListData[i-1].id;
              that.updateList(selectItemInfo.id,'reset_weight',relation_id);
            }else{//上移
              relation_id=optionsListData[i+1].id;
              that.updateList(selectItemInfo.id,'reset_weight',relation_id);
            }
          }
        }

      }else{
        that.movableViewPosition = movableViewPosition
      }
      that.$apply();
      // console.log(that.data);
    }
    getOptionInfo(id) {
      for(var i=0,j=this.data.optionsListData.length;i<j;i++){
        var optionData= this.data.optionsListData[i];
        if(optionData.id == id){
          optionData.selectIndex = i;
          return optionData;
        }
      }
      return {};
    }
    getPositionDomByXY(potions) {
      var y = potions.y-this.data.scrollPosition.top+this.data.scrollPosition.scrollTop - 80;
      console.log(potions.y,this.data.scrollPosition.top,this.data.scrollPosition.scrollTop)
      var optionsListData = this.data.optionsListData;
      var everyOptionCell = this.data.scrollPosition.everyOptionCell;
      for(var i=0,j=optionsListData.length;i<j;i++){
        if(y>=i*everyOptionCell&&y<(i+1)*everyOptionCell){
          return optionsListData[i];
        }
      }
      console.log(optionsListData,'aasdasdasdas')
      return optionsListData[0];
    }
    optionsDataTranlate(optionsList,selectClass) {
      for(var i=0,j=optionsList.length;i<j;i++){
        optionsList[i].selectClass = selectClass;
      }
      return optionsList;
    }
    updateList(id,operate,relation_id){
      // wx.showLoading({
      //   mask:true
      // });
      var that=this;
      var ajaxData={};

    }
  onShow(){
    var that=this;
    // if(app.globalData.refresh_list){
    //   app.globalData.refresh_list = false;
    //   that.setData({
    //     page:0
    //   })
    //   that.getData();
    // }
    // app.globalData.refresh_list = false;

  }
    methods = {
      changeRoute(item){
        if(item.trtype != 2){
          wx.navigateTo({
            url: '/pages/travel/circleDetail?trid='+item.trid
          });
        }
      },
      toOtherMain(item){
        if(!item.is_own && item.author.usid){
          wx.navigateTo({
            url: '/pages/personal/mainIndex?usid='+item.author.usid
          });
        }

      },
      //预览图片
      previewImage(item){

        let that = this;
        if(this.list.length > 0){
          for(let i=0;i<this.list.length;i++){
            if(this.list[i].picture){
              this.img_list.push(this.list[i].picture);
            }
            if(this.list[i].image){
              this.img_list = this.img_list.concat(this.list[i].image);
            }
          }
          this.$apply();
        }
        wx.previewImage({
          current: item, // 当前显示图片的http链接
          urls: that.img_list // 需要预览的图片http链接列表
        })
      },
      follow(index){
        this.postData(this.list[index].author.usid,index);
      },
      toggleDelet:function(e){
        var that=this,
          optionsListData=that.data.optionsListData,
          index=parseInt(e.currentTarget.dataset.index);
        if(optionsListData[index].show_delet){
          optionsListData[index].show_delet=false;
        }else{
          for(let i=0;i<optionsListData.length;i++){
            optionsListData[i].show_delet=false;
          }
          optionsListData[index].show_delet=true;
        }
        that.setData({
          optionsListData:optionsListData
        })
      },
      goMap:function(e){
        var that=this,
          optionsListData=that.data.optionsListData,
          index=e.currentTarget.dataset.index;
        if(optionsListData[index].latitude && optionsListData[index].latitude != null){
          wx.openLocation({
            latitude: optionsListData[index].latitude,
            longitude: optionsListData[index].longitude,
            scale: 14,
            name: optionsListData[index].name,
            address: optionsListData[index].address
          })
        }
      },
      scrolltolower:function(){
        var that =this;
        if(that.data.has_next ){
          if(that.data.has_next){
            that.getData();
          }
        }
      },
      handletouchmove: function(event) {
        // console.log(event)
        var that=this;
        if (that.data.flag!== 0){
          return
        }
        let currentX = event.touches[0].pageX;
        let currentY = event.touches[0].pageY;
        let tx = currentX - that.data.lastX;
        let ty = currentY - that.data.lastY;
        // let text = "";
        //左右方向滑动
        if (Math.abs(tx) > Math.abs(ty)) {
          let scrollPosition=that.data.scrollPosition;
          scrollPosition.scrollY = false;
          that.setData({
            scrollPosition:scrollPosition
          })
          if (tx < -80 && (ty <= 50 && ty >= -50)) {
            // text = "向左滑动";
            that.data.flag= 1;
            if(that.data.swiper_index != undefined){
              let index = that.data.swiper_index;
              let optionsListData = that.data.optionsListData;
              for(let i=0;i<optionsListData.length;i++){
                optionsListData[i].show_delet=false;
              }
              optionsListData[index].show_delet=true;
              that.setData({
                optionsListData:optionsListData
              });
            }
            let scrollPosition=that.data.scrollPosition;
            scrollPosition.scrollY = true;
            that.scrollPosition = scrollPosition
            that.$apply();
          }
          else if (tx > 80 && (ty <= 50 && ty >= -50)) {
            // text = "向右滑动";
            that.data.flag= 2;
            if(that.data.swiper_index != undefined){
              let index = that.data.swiper_index;
              let optionsListData = that.data.optionsListData;
              optionsListData[index].show_delet=false;
              that.optionsListData = optionsListData
              that.$apply();
            }
            let scrollPosition=that.data.scrollPosition;
            scrollPosition.scrollY = true;
            that.scrollPosition = scrollPosition
            that.$apply();
          }
        }else{
          let scrollPosition=that.data.scrollPosition;
          scrollPosition.scrollY = true;
          that.scrollPosition = scrollPosition
          that.$apply();
        }

        //将当前坐标进行保存以进行下一次计算
        // this.data.lastX = currentX;
        // this.data.lastY = currentY;
        // console.log(text);
      },

      handletouchstart:function(event) {
        // console.log(event)
        var that=this;
        that.data.lastX = event.touches[0].pageX;
        that.data.lastY = event.touches[0].pageY;
        if(event.currentTarget.dataset.index != undefined){
          that.swiper_index = event.currentTarget.dataset.index
          that.$apply();
        }
      },
      fadeoutBox:function(e){
        var that=this,
          index=e.currentTarget.dataset.index;
        let optionsListData = that.data.optionsListData;
        optionsListData[index].show_delet=false;
        that.optionsListData =optionsListData
        that.$apply();
      },
      handletouchend:function(event) {
        var that=this;
        that.data.flag= 0 ;
        // console.log('结束滑动');
        let scrollPosition=that.data.scrollPosition;
        scrollPosition.scrollY = true;
        that.scrollPosition = scrollPosition;
        that.$apply();
      },
      toggleAssistant:function(){
        var that=this;
        that.setData({
          show_assistant:!that.data.show_assistant
        })
      },
      completedown:function(e){
        var that=this;
        var flag=e.currentTarget.dataset.flag;
        var id=e.currentTarget.dataset.id;
        that.data.move_type = 'reset_status';
        if(that.data.animation_flag != ''){//阻止重复点击
          return false;
        }
        var optionsListData=that.data.optionsListData;
        var move_num=parseInt(optionsListData.length) - parseInt(flag) -1;
        var scroll_num=0;
        if(move_num >= 3){
          scroll_num=482;
        }else{
          scroll_num=e.changedTouches[0].clientY + 135*move_num;
        }

        that.animation_flag = flag;
        that.$apply();
        that.scrollTouchStart(e);
        // console.log(e);
        // setTimeout(function(){
        var point_move=setInterval(function(){
          if(e.changedTouches[0].clientY <= scroll_num){
            e.changedTouches[0].clientY+=30;
            e.changedTouches[0].pageY+=30;
            that.scrollTouchMove(e);
          }else{
            clearInterval(point_move);
            that.animation_flag = '';
            that.$apply();
            that.scrollTouchEnd(e);

            var n=parseInt(optionsListData.length -1);
            var relation_id = optionsListData[n].id;
            that.updateList(id,'reset_status',relation_id);
            // console.log('end');
            return false;
          }
        },10)
        // },100)


      },
      completeup:function(e){
        var that=this;
        var flag=e.currentTarget.dataset.flag;
        var id=e.currentTarget.dataset.id;
        that.data.move_type = 'reset_status';
        if(that.data.animation_flag != ''){//阻止重复点击
          return false;
        }
        var optionsListData=that.data.optionsListData;
        var move_num=parseInt(flag);
        var scroll_num=0;
        if(move_num >= 3){
          scroll_num=0;
        }else{
          scroll_num=e.changedTouches[0].clientY - 135*move_num;
        }

        that.setData({
          animation_flag:flag
        })
        that.scrollTouchStart(e);
        // console.log(e);
        // setTimeout(function(){
        var point_move=setInterval(function(){
          if(e.changedTouches[0].clientY >= scroll_num){
            e.changedTouches[0].clientY-=30;
            e.changedTouches[0].pageY-=30;
            that.scrollTouchMove(e);
          }else{
            clearInterval(point_move);
            that.animation_flag =''
            that.scrollTouchEnd(e);

            var relation_id = optionsListData[0].id;
            that.updateList(id,'reset_status',relation_id);
            // console.log('end');
            return false;
          }
        },10)
        // },100)
      },
      deletItem:function(e){
        var that=this;
        var id=e.currentTarget.dataset.id;
        that.data.deletItem_id = id;
        that.$apply();
        that.showdialog();
      },
      confirmEvent:function(){
        var that=this;
        that.hidedialog();
        that.updateList(that.data.deletItem_id,'disable');
      },
      preventD:function(){

      },
      showdialog:function(){
        var that=this;
        that.isShow = true;
        that.$apply();
      },
      hidedialog:function(){
        var that=this;
        that.isShow =false;
        that.$apply();
      },
      goUrl:function(e){
        var that=this;
        var url=e.currentTarget.dataset.url;
        var id=e.currentTarget.dataset.id;
        var index=e.currentTarget.dataset.index;
        var optionsListData=that.data.optionsListData;
        var status=parseInt(e.currentTarget.dataset.status);

        if(status == 0){//已完成card，不支持跳转
          return false;
        }else{
          if(url && url != null){
            if(optionsListData[index].is_extend && !optionsListData[index].readed){
              wx.request({
                url: api.domain + '/v1/user_todo/'+id+'/readed/',
                method: 'GET',
                header: {
                  Authorization: 'Bearer ' + app.globalData.jwt_token
                },
                success: res => {
                  // console.log(res);
                  wx.navigateTo({ url: url+'&id='+id});
                }
              })
            }else{
              wx.navigateTo({ url: url+'&id='+id});
            }

          }
        }
      },
      htouchmove:function(e){
        // console.log(e);
      },
      longpressfuc:function(e){
        var movableViewPosition={
          x:0,
          y:80,
          className:"none",
          data:{
            icon_type:1,
            is_complete:true
          }
        };
        this.movableViewPosition = movableViewPosition;
        this.$apply();
        console.log('pngpress')
        this.scrollTouchStart(e);

      },
      bindscroll:function (event) {
        var scrollTop = event.detail.scrollTop;
        this.scrollPosition.scrollTop =scrollTop;

        if(scrollTop >= 61){
          if(this.data.navigationBarTitle != '拖拽排序+左滑删除'){
            wx.setNavigationBarTitle({
              title: '拖拽排序+左滑删除'
            })
            this.navigationBarTitle = '拖拽排序+左滑删除'

          }

        }else{
          if(this.data.navigationBarTitle != ''){
            wx.setNavigationBarTitle({
              title: ''
            })
            this.navigationBarTitle=''
          }
        }

        this.$apply();
      },

      draggleTouch:function (event) {
        console.log(event)
        var touchType = event.type;
        switch(touchType){
          case "touchstart":
            this.scrollTouchStart(event);
            break;
          case "touchmove":
            this.scrollTouchMove(event);
            break;
          case "touchend":
            this.scrollTouchEnd(event);
            break;
        }
      },


    }
  }
</script>
